# 敏感信息扫描工具 v1.0

一个功能强大的敏感信息扫描工具，专门用于检测文件中的敏感信息、API接口、密钥等潜在安全风险。同时集成了Webpack反编译功能，支持对前端打包网站进行深度分析。

## 主要功能

### 🔍 文件扫描功能
- **多线程扫描**: 支持1-16个线程并发扫描，大幅提升扫描效率
- **智能文件类型识别**: 自动识别并扫描JS、TS、HTML、CSS、JSON等多种文件类型
- **正则规则匹配**: 基于正则表达式的高精度匹配引擎
- **实时进度显示**: 扫描过程实时显示进度和统计信息

### 📋 规则管理系统
- **分类管理**: 支持按类型分类管理扫描规则
- **自定义规则**: 用户可以添加、删除、修改扫描规则
- **规则测试**: 内置规则测试功能，验证正则表达式有效性
- **规则导入导出**: 支持规则配置的备份和恢复
- **YAML批量导入**: 支持从YAML文件批量导入规则，兼容多种规则格式

### 🎯 敏感信息分类
默认支持以下类型的敏感信息检测：
- **API接口**: REST API、GraphQL接口等
- **密钥信息**: API Key、Secret Key、Access Token等
- **个人信息**: 邮箱地址、手机号码等
- **网络信息**: IP地址、域名等
- **数据库连接**: MySQL、MongoDB、PostgreSQL连接字符串
- **云服务配置**: AWS、阿里云等云服务配置信息

### 🔧 Webpack反编译工具
- **网站检测**: 自动检测目标网站是否使用Webpack打包
- **JS文件提取**: 智能提取网站中的JavaScript文件
- **Source Map分析**: 检测和分析.map文件
- **API接口发现**: 从打包文件中提取API接口信息
- **敏感信息挖掘**: 从前端代码中发现潜在的敏感信息

### 📊 结果展示与操作
- **智能筛选**: 复选框式分类筛选，支持全选/取消全选操作
- **单例预览**: 单击结果项显示代码预览窗口，避免重复窗口
- **导航预览**: 预览窗口内置左右导航按钮，快速浏览所有结果
- **代码上下文**: 显示前后50行代码，高亮匹配行，居中显示
- **文件跳转**: 双击结果项或预览窗口中点击"打开文件"跳转到对应行
- **可调列宽**: 结果表格列宽支持手动拖拽调节
- **结果导出**: 支持导出为JSON、CSV格式
- **优化布局**: 文件类型选择器紧凑布局，窗口居中显示

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用说明

### 启动程序
```bash
python main.py
```

### 基本操作流程

1. **选择扫描目录**
   - 点击"浏览"按钮选择要扫描的文件夹
   - 或直接在输入框中输入路径

2. **配置扫描参数**
   - 点击"选择"按钮打开文件类型选择器，选择要扫描的文件类型
   - 调整线程数（建议2-8个线程）

3. **开始扫描**
   - 点击"开始扫描"按钮
   - 观察进度条和状态信息
   - 可随时点击"停止扫描"中断操作

4. **查看结果**
   - 在左侧面板使用复选框选择要查看的敏感信息类型
   - 使用"全选"/"取消"按钮快速切换所有分类
   - 在结果表格中查看详细信息，可拖拽调节列宽
   - 单击查看代码预览（居中显示，前后50行上下文）
   - 使用预览窗口的"◀ 上一个"/"下一个 ▶"按钮导航浏览
   - 双击结果项或预览窗口中点击"打开文件"跳转到对应行

5. **导出结果**
   - 通过"文件"菜单选择"导出结果"
   - 支持JSON和CSV两种格式

### 规则管理

1. **打开规则管理器**
   - 点击"工具" → "规则管理"

2. **添加新分类**
   - 在左侧分类列表中点击"添加分类"
   - 输入分类名称

3. **添加规则**
   - 选择目标分类
   - 在规则输入框中输入正则表达式
   - 点击"添加规则"

4. **测试规则**
   - 选择要测试的规则
   - 点击"测试规则"
   - 在测试窗口中输入测试文本验证效果

5. **批量导入规则**
   - 点击"导入YAML"按钮
   - 选择符合格式的YAML规则文件（如test_rules.yml）
   - 选择"合并"或"替换"现有规则

### Webpack工具使用

1. **打开Webpack工具**
   - 点击"工具" → "Webpack反编译"

2. **分析网站**
   - 输入目标网站URL
   - 点击"开始分析"
   - 查看分析结果

## 默认扫描规则

### API接口
- `/api/[^'\"\\s]+` - 标准API路径
- `\.get\(['\"]([^'\"]+)['\"]` - GET请求
- `\.post\(['\"]([^'\"]+)['\"]` - POST请求
- `method:\s*['\"]get['\"]` - GET方法声明
- `method:\s*['\"]post['\"]` - POST方法声明

### 密钥信息
- `api[_-]?key['\"]?\s*[:=]\s*['\"]([a-zA-Z0-9_-]{16,})['\"]` - API密钥
- `secret[_-]?key['\"]?\s*[:=]\s*['\"]([a-zA-Z0-9_-]{16,})['\"]` - 密钥
- `access[_-]?token['\"]?\s*[:=]\s*['\"]([a-zA-Z0-9_-]{16,})['\"]` - 访问令牌
- `private[_-]?key['\"]?\s*[:=]\s*['\"]([a-zA-Z0-9_-]{16,})['\"]` - 私钥

### 个人信息
- `\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b` - 邮箱地址
- `1[3-9]\d{9}` - 中国手机号
- `\+86\s*1[3-9]\d{9}` - 带国际区号的手机号

### 网络信息
- `\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b` - IPv4地址

### 数据库连接
- `jdbc:[^'\"\\s]+` - JDBC连接字符串
- `mongodb://[^'\"\\s]+` - MongoDB连接
- `mysql://[^'\"\\s]+` - MySQL连接
- `postgresql://[^'\"\\s]+` - PostgreSQL连接

### 云服务配置
- `AKIA[0-9A-Z]{16}` - AWS Access Key ID
- `aws_secret_access_key['\"]?\s*[:=]\s*['\"]([a-zA-Z0-9/+=]{40})['\"]` - AWS Secret Key
- `aliyun[_-]?access[_-]?key['\"]?\s*[:=]\s*['\"]([a-zA-Z0-9_-]{16,})['\"]` - 阿里云Access Key

## 技术特性

### 性能优化
- **多线程扫描**: 利用线程池并发处理文件
- **智能编码检测**: 自动检测文件编码，支持UTF-8、GBK等多种编码
- **内存优化**: 流式处理大文件，避免内存溢出
- **结果缓存**: 智能缓存扫描结果，提升响应速度

### 安全特性
- **文件大小限制**: 自动跳过超大文件（默认50MB）
- **异常处理**: 完善的异常处理机制，确保程序稳定性
- **编码安全**: 安全的文件读取方式，防止恶意文件攻击

### 扩展性
- **插件化架构**: 模块化设计，便于功能扩展
- **规则热更新**: 支持运行时更新扫描规则
- **API接口**: 预留API接口，支持程序化调用

## 注意事项

1. **文件权限**: 确保程序有足够权限访问目标文件夹
2. **杀毒软件**: 某些杀毒软件可能会误报，请添加信任
3. **大文件处理**: 扫描大量文件时建议适当增加线程数
4. **正则表达式**: 添加自定义规则时注意正则表达式的性能影响
5. **网络访问**: Webpack工具需要网络访问权限

## YAML规则文件格式

支持导入YAML格式的规则文件，格式如下：

```yaml
- group: "规则分组名称"
  rules:
  - name: "规则名称"
    loaded: true    # true=启用, false=禁用
    regex: '正则表达式'
  - name: "另一个规则"
    loaded: false
    regex: '另一个正则表达式'

- group: "另一个分组"
  rules:
  - name: "规则3"
    loaded: true
    regex: '第三个正则表达式'
```

**注意事项:**
- 只有`loaded: true`的规则会被导入
- `color`字段会被忽略
- 支持合并导入和替换导入两种模式
- 项目中包含`test_rules.yml`作为示例文件

## 更新日志

### v1.2 (2025-01-12)
- 🎯 实现单例预览窗口，避免重复打开多个预览窗口
- 🧭 添加预览窗口导航功能，支持"上一个"/"下一个"按钮快速浏览
- 🎨 窗口居中显示，优化用户体验
- 📏 结果表格列宽支持手动拖拽调节
- 🗂️ 优化文件类型选择器布局，移除冗余按钮，使用网格布局
- 📊 移除底部统计信息面板，简化界面
- 🐛 修复界面布局和交互问题

### v1.1 (2025-01-12)
- 🎉 添加YAML规则批量导入功能
- 🎨 改进结果筛选界面，使用复选框和全选功能
- 🔧 优化文件类型选择，使用图形化选择器
- 📝 增强代码预览窗口，显示前后50行上下文
- 🚀 简化界面，移除不必要的匹配规则列
- 🐛 修复多项界面和功能问题

### v1.0 (2025-01-12)
- 初始版本发布
- 支持多线程文件扫描
- 集成规则管理系统
- 添加Webpack反编译功能
- 实现结果预览和文件跳转
- 支持多种格式导出

## 许可证

本项目采用MIT许可证，详情请参阅LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来帮助改进这个项目！

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至：[your-email@example.com]

---

**免责声明**: 本工具仅供安全研究和合法的渗透测试使用，请勿用于非法用途。使用者需要对自己的行为负责。 